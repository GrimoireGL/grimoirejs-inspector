{"version":3,"sources":["webpack:///webpack/bootstrap e56707b20ff2c5d21c5b","webpack:///./src/background/background.js","webpack:///./src/background/MessageManager.js"],"names":["mm","console","log","chrome","runtime","onConnect","addListener","port","devtoolListener","message","sender","sendResponse","verifyDevtoolMessage","type","establish","toContent","onMessage","onDisconnect","removeListener","devToolsListener","disconnect","request","toDevTool","MessageManager","devToolPort","fromBackground","tabId","tab","id","$source","postMessage","tabs","sendMessage","$tabId"],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;;;ACtCA;;;;;;AACA,KAAMA,KAAK,8BAAX;AACAC,SAAQC,GAAR,CAAY,mBAAZ;AACAC,QAAOC,OAAP,CAAeC,SAAf,CAAyBC,WAAzB,CAAqC,UAASC,IAAT,EAAe;AAChD;AACA,SAAIC,kBAAkB,SAAlBA,eAAkB,CAASC,OAAT,EAAkBC,MAAlB,EAA0BC,YAA1B,EAAwC;AAC1D,aAAIX,GAAGY,oBAAH,CAAwBH,OAAxB,CAAJ,EAAsC;AACpC,iBAAGA,QAAQI,IAAR,KAAiB,sBAApB,EAA2C;AACzCb,oBAAGc,SAAH,CAAaP,IAAb;AACD,cAFD,MAEK;AACHP,oBAAGe,SAAH,CAAaN,OAAb;AACD;AACF;AACJ,MARD;;AAUA;AACAF,UAAKS,SAAL,CAAeV,WAAf,CAA2BE,eAA3B;AACAD,UAAKU,YAAL,CAAkBX,WAAlB,CAA8B,UAASC,IAAT,EAAe;AACzCA,cAAKS,SAAL,CAAeE,cAAf,CAA8BC,gBAA9B;AACAnB,YAAGoB,UAAH;AACH,MAHD;AAIH,EAlBD;;AAoBA;AACA;AACAjB,QAAOC,OAAP,CAAeY,SAAf,CAAyBV,WAAzB,CAAqC,UAASe,OAAT,EAAkBX,MAAlB,EAA0BC,YAA1B,EAAwC;AACzE;AACAX,QAAGsB,SAAH,CAAaD,OAAb,EAAqBX,MAArB;AACA,YAAO,IAAP;AACH,EAJD,E;;;;;;;;;;;;;;;;KCzBqBa,c;AACnB,6BAAa;AAAA;AAEZ;;;;+BAEShB,I,EAAK;AACb,YAAKiB,WAAL,GAAmBjB,IAAnB;AACAN,eAAQC,GAAR,CAAY,2BAAZ;AACAD,eAAQC,GAAR,CAAYK,IAAZ;AACD;;;kCAEW;AACV,WAAG,KAAKiB,WAAR,EAAoB;AAClB,cAAKA,WAAL,GAAmB,IAAnB;AACD;AACF;;;+BAESH,O,EAAQX,M,EAAOe,c,EAAe;AACtC,WAAMC,QAAQhB,SAAOA,OAAOiB,GAAP,CAAWC,EAAlB,GAAqB,IAAnC;AACA,WAAKP,QAAQQ,OAAR,KAAoB,oBAApB,IAA4CH,UAAU,KAAKA,KAA5D,IAAsED,cAA1E,EAA0F;AACtF,aAAG,KAAKD,WAAR,EAAoB;AAClB,gBAAKA,WAAL,CAAiBM,WAAjB,CAA6BT,OAA7B;AACApB,mBAAQC,GAAR;AACAD,mBAAQC,GAAR,CAAYmB,OAAZ;AACD;AACJ;AACF;;;+BAESZ,O,EAAQ;AAChB,WAAI,KAAKG,oBAAL,CAA0BH,OAA1B,CAAJ,EAAwC;AACpCN,gBAAO4B,IAAP,CAAYC,WAAZ,CAAwBvB,QAAQwB,MAAhC,EAAwCxB,OAAxC;AACA,cAAKiB,KAAL,GAAajB,QAAQwB,MAArB;AACAhC,iBAAQC,GAAR,kCAA2CO,QAAQwB,MAAnD;AACAhC,iBAAQC,GAAR,CAAYO,OAAZ;AACH;AACF;;;0CAEoBA,O,EAAQ;AAC3B,cAAOA,QAAQoB,OAAR,KAAoB,6BAA3B;AACD;;;;;;mBAvCkBN,c","file":"./lib/background.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap e56707b20ff2c5d21c5b","import MessageManager from \"./MessageManager\";\nconst mm = new MessageManager();\nconsole.log(\"background script\");\nchrome.runtime.onConnect.addListener(function(port) {\n    // devTools側からのリスナー\n    var devtoolListener = function(message, sender, sendResponse) {\n        if (mm.verifyDevtoolMessage(message)) {\n          if(message.type === \"connection-establish\"){\n            mm.establish(port);\n          }else{\n            mm.toContent(message);\n          }\n        }\n    }\n\n    // Listen to messages sent from the DevTools page\n    port.onMessage.addListener(devtoolListener);\n    port.onDisconnect.addListener(function(port) {\n        port.onMessage.removeListener(devToolsListener);\n        mm.disconnect();\n    });\n});\n\n// Receive message from content script and relay to the devTools page for the\n// current tab\nchrome.runtime.onMessage.addListener(function(request, sender, sendResponse) {\n    // Messages from content scripts should have sender.tab set\n    mm.toDevTool(request,sender);\n    return true;\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/background/background.js","export default class MessageManager{\n  constructor(){\n\n  }\n\n  establish(port){\n    this.devToolPort = port;\n    console.log(\"connection established to\");\n    console.log(port);\n  }\n\n  disconnect(){\n    if(this.devToolPort){\n      this.devToolPort = null;\n    }\n  }\n\n  toDevTool(request,sender,fromBackground){\n    const tabId = sender?sender.tab.id:null;\n    if ((request.$source === \"grimoire-inspector\" && tabId === this.tabId) || fromBackground) {\n        if(this.devToolPort){\n          this.devToolPort.postMessage(request);\n          console.log(`Background -> DevTool`);\n          console.log(request);\n        }\n    }\n  }\n\n  toContent(message){\n    if (this.verifyDevtoolMessage(message)) {\n        chrome.tabs.sendMessage(message.$tabId, message);\n        this.tabId = message.$tabId;\n        console.log(`Background -> ContentScript:${message.$tabId}`);\n        console.log(message);\n    }\n  }\n\n  verifyDevtoolMessage(message){\n    return message.$source === \"grimoire-inspector-dev-tool\";\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/background/MessageManager.js"],"sourceRoot":""}