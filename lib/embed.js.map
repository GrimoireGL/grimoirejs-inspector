{"version":3,"sources":["webpack:///webpack/bootstrap 586988d675a45da288c0","webpack:///./src/embed/embed.js","webpack:///./src/embed/MessageManager.js","webpack:///./src/embed/ObjectConverter.js","webpack:///./src/embed/AttributeWatcher.js"],"names":["on","window","GrimoireJS","observeRoot","element","observer","MutationObserver","mutations","forEach","mutation","type","i","addedNodes","length","addedNode","post","parent","fromElement","parentElement","root","observe","attributes","childList","characterData","subtree","m","removeHandlers","node","nodeDictionary","key","components","_components","map","fromComponent","nodeName","name","className","id","watch","rootNodes","result","rootNode","scriptElement","companion","get","MessageManager","handlers","addEventListener","onRecieve","bind","message","data","$source","Error","packet","Object","assign","postMessage","handler","ObjectConverter","noRecursive","children","push","getAttribute","tagName","component","toArray","fromAttribute","attr","converter","declaration","value","Value","rawElements","isColor","isVector","indexOf","eularAngles","e","toString","AttributeWatcher","watching","cName","attrName","c","a","addHandler","onChanged","func","target","removeObserver","splice"],"mappings":"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","file":"./lib/embed.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 586988d675a45da288c0","import MessageManager from \"./MessageManager\";\nimport ObjectConverter from \"./ObjectConverter\";\nimport AttributeWatcher from \"./AttributeWatcher\";\nMessageManager.on(\"sync-devtool\", function() {\n    if(!!window.GrimoireJS) {\n        function observeRoot(element) {\n            const observer = new MutationObserver((mutations) => {\n                mutations.forEach((mutation) => {\n                    if (mutation.type === \"childList\") {\n                        for (let i = 0; i < mutation.addedNodes.length; i++) {\n                            const addedNode = mutation.addedNodes[i];\n                            MessageManager.post({\n                                type: \"node-added\",\n                                parent: ObjectConverter.fromElement(addedNode.parentElement),\n                                addedNode: ObjectConverter.fromElement(addedNode),\n                                root: ObjectConverter.fromElement(element)\n                            })\n                        }\n                    }\n                });\n            });\n            observer.observe(element, {\n                attributes: true,\n                childList: true,\n                characterData: true,\n                subtree: true\n            });\n        }\n\n        MessageManager.on(\"fetch-node\", function(m) {\n            AttributeWatcher.removeHandlers();\n            const node = window.GrimoireJS.nodeDictionary[m.key];\n            if (!node) {\n                return;\n            }\n            const components = node._components.map(m=>ObjectConverter.fromComponent(m));\n            MessageManager.post({\n                type: \"node-info\",\n                nodeName: node.name.name,\n                className: node.element.className,\n                id: node.element.id,\n                components: components\n            });\n            AttributeWatcher.watch(node);\n        });\n\n        for (let key in window.GrimoireJS.rootNodes) {\n            const root = window.GrimoireJS.rootNodes[key];\n            MessageManager.post({\n                type: \"new-tree\",\n                result: {\n                    key: key,\n                    rootNode: ObjectConverter.fromElement(root.element),\n                    scriptElement: ObjectConverter.fromElement(root.companion.get(\"scriptElement\"), true)\n                }\n            });\n            observeRoot(root.element);\n        }\n    }\n});\nMessageManager.post({\n    type: \"initialize\"\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/embed/embed.js","class MessageManager {\n    constructor() {\n      this.handlers = {};\n      window.addEventListener(\"message\",this.onRecieve.bind(this));\n    }\n\n    onRecieve(message){\n      if(message.data.$source !== \"grimoire-inspector-dev-tool\"){\n        return;\n      }\n      if(this.handlers[message.data.type]){\n        this.handlers[message.data.type](message.data);\n      }else{\n        throw new Error(\"No handler found for \" + message.data.type);\n      }\n    }\n\n    post(message) {\n        const packet = Object.assign({\n            $source: \"grimoire-inspector\"\n        }, message);\n        if(packet.type === void 0){\n          throw new Error(\"Type must be specified\");\n        }\n        window.postMessage(packet, \"*\");\n    }\n\n    on(type,handler){\n      this.handlers[type] = handler;\n    }\n}\n\nexport default new MessageManager();\n\n\n\n// WEBPACK FOOTER //\n// ./src/embed/MessageManager.js","class ObjectConverter {\n    fromElement(element, noRecursive) {\n        let children;\n        if (!noRecursive) {\n            children = [];\n            for (let i = 0; i < element.children.length; i++) {\n                children.push(this.fromElement(element.children[i]));\n            }\n        }\n        return {\n            key: element.getAttribute(\"x-gr-id\"),\n            className: element.className,\n            tagName: element.tagName,\n            id: element.id,\n            children: children\n        };\n    }\n\n    fromComponent(component) {\n        return {\n            name: component.name.name,\n            attributes: component.attributes.toArray().map(m => this.fromAttribute(m))\n        };\n    }\n\n    fromAttribute(attr) {\n        try {\n            const converter = attr.declaration.converter;\n            switch (converter) {\n                case \"Number\":\n                case \"String\":\n                case \"Angle2D\":\n                case \"Boolean\":\n                    return {\n                        name: attr.name.name,\n                        value: attr.Value\n                    };\n                case \"Color3\":\n                case \"Color4\":\n                    return {\n                        name: attr.name.name,\n                        value: attr.Value.rawElements,\n                        isColor: true\n                    };\n                case \"Vector2\":\n                case \"Vector3\":\n                case \"Vector4\":\n                    return {\n                        name: attr.name.name,\n                        value: attr.Value.rawElements,\n                        isVector: true,\n                        length: [\"Vector2\", \"Vector3\", \"Vector4\"].indexOf(converter) + 2\n                    };\n                case \"Rotation3\":\n                    return {\n                        name: attr.name.name,\n                        value: attr.Value.eularAngles.rawElements,\n                        isVector: true,\n                        length: 3\n                    };\n                default:\n                    return {\n                        name: attr.name.name,\n                        value: !!attr.Value ? \"(Object)[Non Editable]\" : \"(null or undefined)[Non Editable]\"\n                    };\n            }\n        } catch (e) {\n            return {\n                name: attr.name.name,\n                value: e.toString()\n            };\n        }\n    }\n}\n\nexport default new ObjectConverter();\n\n\n\n// WEBPACK FOOTER //\n// ./src/embed/ObjectConverter.js","import MessageManager from \"./MessageManager\";\nimport ObjectConverter from \"./ObjectConverter\";\nclass AttributeWatcher {\n    constructor() {\n        this.watching = [];\n        this.components = {};\n        MessageManager.on(\"attribute-manual-change\", (m) => {\n          this.components[m.cName][m.attrName].Value = m.value;\n        });\n    }\n\n    watch(node) {\n        this.node = node;\n        node._components.forEach(c => {\n            this.components[c.name.name] = {};\n            c.attributes.toArray().forEach(a=>{\n              this.components[c.name.name][a.name.name] = a;\n            })\n        });\n        node._components.forEach(c => c.attributes.toArray().forEach(a => this.addHandler(a, this.onChanged.bind(this))));\n    }\n\n    onChanged() {\n        const components = this.node._components.map(m => ObjectConverter.fromComponent(m));\n        MessageManager.post({\n            type: \"attribute-update\",\n            components: components\n        });\n    }\n\n    addHandler(attr, func) {\n        this.watching.push({\n            attr: attr,\n            handler: func\n        });\n        attr.watch(func);\n    }\n\n    removeHandlers() {\n        for (let i = 0; i < this.watching.length; i++) {\n            const target = this.watching[i];\n            target.attr.removeObserver(target.handler);\n        }\n        this.watching.splice(0, this.watching.length);\n    }\n}\n\nexport default new AttributeWatcher();\n\n\n\n// WEBPACK FOOTER //\n// ./src/embed/AttributeWatcher.js"],"sourceRoot":""}